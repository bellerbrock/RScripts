---
title: "Testing Blockiness Trait"
author: "Bryan"
date: "February 13, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Rough Calculation of Blockiness

```{r}
# Define names (Change each time)
filepath <- "/home/bryan/Downloads/17CHMC0024CUN_harvest.csv"
trialname <- "17CHMC0024CUN"

# Read in csv file
data <- read.csv(filename, header = TRUE, check.names = TRUE,  stringsAsFactors = FALSE)

# Define cups based on color
data <- within(data, accession_name[color == 15790320] <- 'All_Cups')

# Calculate max root areas
data$max.area <- as.numeric(data$estimated.length) * as.numeric(data$estimated.diameter)

# Calculating 1st cup's blockiness in order to express everything else in terms of it
cup_area <- data[match("All_Cups", data$accession_name),which(colnames(data)=="max.area")]
cup_weight <- data[match("All_Cups", data$accession_name),which(colnames(data)=="estimaged.weight")]
cup_blockiness <- cup_area / cup_weight

# Calculate blockiness as % of 1st cup for each root
data$blockiness <- cup_blockiness / ( data$max.area /  as.numeric(data$estimaged.weight) )

# Filter to remove canners and culls by keeping only roots with diam >= 200 and length >= 299 and weight >=50
No1s_and_Jumbos <- data[data$estimated.diameter >= 200 & data$estimated.length >= 300 & data$estimaged.weight >= 50,]

# Adjust plot size to fit vertical x labels
par(mar=c(10,5,4,2))

# Draw boxplot
title <- paste("Storage Root Blockiness", trialname, sep=" ") 
boxplot(blockiness~accession_name, data=No1s_and_Jumbos, main=title, ylab="Blockiness", las=2)

```
